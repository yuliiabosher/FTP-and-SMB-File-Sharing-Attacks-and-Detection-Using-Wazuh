<!-- Local rules -->

<!-- Modify it at your will. -->
<!-- Copyright (C) 2015, Wazuh Inc. -->

<!-- Example -->
<group name="local,syslog,sshd,">

  <!--
  Dec 10 01:02:02 host sshd[1234]: Failed none for root from 1.1.1.1 port 1066 ssh2
  -->
  <rule id="100001" level="5">
    <if_sid>5716</if_sid>
    <srcip>1.1.1.1</srcip>
    <description>sshd: authentication failed from IP 1.1.1.1.</description>
    <group>authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,</group>
  </rule>

</group>

<group name="ftp,samba">

  <rule id="100107" level="6">
    <if_sid>11402</if_sid>
    <match>anon password</match>
    <description>Anonymous FTP login</description>
  </rule>

</group>

<group name="ftp,samba,">
  
  <rule id="100108" level="12">
    <if_sid>554</if_sid>
    <match>.php</match>
    <description>PHP file upload to SMB share</description>
  </rule>

</group>

<group name="ftp,samba,">

  <rule id="100109" level="5">
    <if_sid>80700</if_sid>
    <field name="audit.key">ftp_read</field>
    <description>FTP read access</description>
  </rule>

</group>

<group name="file_transfer,">

  <rule id="100110" level="12">
    <if_sid>80700</if_sid>
    <list field="audit.command" lookup="match_key_value" check_value="data_transfer">etc/lists/suspicious-programs</list>
    <match>/root|/etc</match>
    <description>Data transfer from protected directories</description>
  </rule>

</group>

<group name="apache,">

  <rule id="100111" level="13">
    <if_sid>31108</if_sid>
    <match>.php</match>
    <description>HTTP request to a PHP file upload</description>
  </rule>

</group>

<group name="file_transfer,">

  <rule id="100112" level="13">
    <if_sid>80700</if_sid>
    <field name="audit.key">protected_dir_read</field>
    <description>Read access to protected directories</description>
  </rule>

</group>

<group name="file_transfer,">

  <rule id="100113" level="14" frequency="100" timeframe="60">
    <if_sid>100110</if_sid>
    <if_matched_sid>100112</if_matched_sid>
    <description>Large file transfer from protected directories</description>
  </rule>

</group>

<group name="archive_creation,">

  <rule id="100114" level="14">
    <if_sid>80700</if_sid>
    <list field="audit.command" lookup="match_key_value" check_value="archive_creation">etc/lists/suspicious-programs</list>
    <match>/var/lib/mysql</match>
    <description>Archive creation of data directory in a shared folder</description>
  </rule>

</group>
